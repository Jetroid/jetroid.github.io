var symbolSpansLeft=[],symbolSpansRight=[],pointerSpansLeft=[],pointerSpansRight=[],allWords=[],words=[],goalWord="",wordlength=0,attempts=4,hadRefresh=!1,clickedBrackets=new Set,terminalLocked=!1,commandPromptText=[{text:"WELCOME TO ROBCO INDUSTRIES (TM) TERMLINK",isMachine:!0,delay:10,targetId:"loading-welcome"},{text:">",isMachine:!0,delay:400,targetId:"loading-firsttype"},{text:"SET TERMINAL/INQUIRE",delay:50,targetId:"loading-firsttype"},{text:"RX-9000",isMachine:!0,delay:10,targetId:"loading-terminalmodel"},{text:">",isBreak:!0,delay:200,targetId:"loading-secondtype"},{text:"SET FILE/PROTECTION=OWNER:RWED ACCOUNTS.F",delay:55,targetId:"loading-secondtype"},{text:">",isBreak:!0,delay:800,targetId:"loading-thirdtype"},{text:"SET HALT RESTART/MAINT",delay:50,targetId:"loading-thirdtype"},{text:"Initializing RobCo Industries(TM) MF Boot Agent v2.3.0",isMachine:!0,delay:10,targetId:"loading-information"},{text:"<br>",isBreak:!0,isSilent:!0,delay:100,targetId:"loading-information"},{text:"RETROS BIOS",isMachine:!0,delay:10,targetId:"loading-information"},{text:"<br>",isBreak:!0,isSilent:!0,delay:150,targetId:"loading-information"},{text:"RBIOS-4.02.08.00 52EE5.E7.E8",isMachine:!0,delay:10,targetId:"loading-information"},{text:"<br>",isBreak:!0,isSilent:!0,delay:200,targetId:"loading-information"},{text:"Copyright 2075-2077 RobCo Ind.",isMachine:!0,delay:10,targetId:"loading-information"},{text:"<br>",isBreak:!0,isSilent:!0,delay:600,targetId:"loading-information"},{text:"Uppermem: 1024 KB",isMachine:!0,delay:10,targetId:"loading-information"},{text:"<br>",isBreak:!0,isSilent:!0,delay:150,targetId:"loading-information"},{text:"Root (5A8)",isMachine:!0,delay:10,targetId:"loading-information"},{text:"<br>",isBreak:!0,isSilent:!0,delay:150,targetId:"loading-information"},{text:"Maintenance Mode",isMachine:!0,delay:10,targetId:"loading-information"},{text:">",isBreak:!0,delay:150,targetId:"loading-fourthtype"},{text:"RUN DEBUG/ACCOUNTS.F",delay:45,targetId:"loading-fourthtype"}],minigameText=[{text:"ROBCO INDUSTRIES (TM) TERMLINK PROTOCOL",isMachine:!0,delay:10},{text:"ENTER PASSWORD NOW",isMachine:!0,delay:10},{text:"4 Attempt(s) Left: ██ ██ ██ ██",isMachine:!0,delay:10}],ptrleft="",ptrright="",symbolsleft="",symbolsright="",finishedLoading=!1,finishedPrinting=!1,minigameSetupBegun=!1,enableMinigame=!1,printCount=0,targetText="",currentText="",highlighted_spans=[],tickNoise=function(){document.getElementById("tick").currentTime=0,document.getElementById("tick").play()},generateDataCorruption=function(){for(var e="",t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ01234567890",n='~#!"$%^&*()_-+=[]{}?/,.',a=["if","it","is","can","we","space","V4ult Teg","Pos0idon Enerxy","J3tRo1d","data","0x0000","FrxquenFy C00tral","yes","no","maybe","believe","God","food","Dog","THr33","LFser RiMle","D3thclRAW","HeliDX Hne","Help Me","MissiX9ippi QuantuXo.z P3!"],o=generateRandomInt(250,300),r=0;r<o;)r++,generateRandomInt(0,100)<80?(generateRandomInt(0,100)<80?e+=t[Math.floor(Math.random()*t.length)]:e+=n[Math.floor(Math.random()*n.length)],1==generateRandomInt(0,10)&&(e+=" ")):a.length>0&&(wordindex=Math.floor(Math.random()*a.length),e+=" "+a[wordindex]+" ",a.splice(wordindex,1)),15==generateRandomInt(0,60)&&(e+="<br>");return e+="<br><br>FATAL ERROR: DATA CORRUPTION DETECTED. <br>PLEASE CHECK ALL CONNECTIONS."},viewPost=function(e){var t=new XMLHttpRequest;t.open("GET",e,!0),t.onreadystatechange=function(){if(t.readyState==XMLHttpRequest.DONE&&200==t.status){var e=t.responseText,n=document.createElement("div");n.innerHTML=e,postContainer=n.querySelectorAll(".post-container")[0];for(var a=postContainer.firstChild;null!=(a=a.nextSibling)&&"post-content"!=a.id;);var o=a;document.getElementById("post-titles-container").style.display="none",(r=document.getElementById("post-container")).style.display="block",r.innerHTML=o.innerHTML,fixImages()}else{var r;document.getElementById("post-titles-container").style.display="none",(r=document.getElementById("post-container")).style.display="block";var i=document.createElement("p");i.innerHTML=generateDataCorruption(),r.innerHTML="",r.appendChild(i)}document.getElementById("enter").play(),resizeLoggedIn()},t.send(null)},exitPost=function(e){var t=(e=window.event||e).target||e.srcElement;"A"!=t.tagName&&"a"!=t.tagName&&(document.getElementById("post-container").style.display="none",document.getElementById("post-titles-container").style.display="block",document.getElementById("enter").play())},resizeLoggedIn=function(){var e=document.getElementById("os-header"),t=e.offsetHeight;t+=parseInt(window.getComputedStyle(e).getPropertyValue("margin-top")),t+=parseInt(window.getComputedStyle(e).getPropertyValue("margin-bottom"));var n=document.getElementById("blog-content");t=document.body.offsetHeight-t;n.style.height=t+"px"},addFeedback=function(e){var t=document.getElementById("feedback").innerHTML;t=t.replace(/^.*?<br>/,""),t+=e+"<br>",document.getElementById("feedback").innerHTML=t},clearEntry=function(){targetText="",currentText="",document.getElementById("entry").innerHTML="",document.getElementById("key2").play(),document.getElementById("hack-cursor").className="cursor-flash"},addEntryCharacter=function(){if(currentText===targetText||currentText.length>=targetText)document.getElementById("hack-cursor").className="cursor-flash";else{playKeyboardSound();var e=currentText+targetText[currentText.length]+targetText[currentText.length+1];currentText=e,document.getElementById("entry").textContent=e;var t=generateRandomInt(0,40);setTimeout(addEntryCharacter,30+t)}},setEntry=function(e){targetText=e,document.getElementById("entry").textContent="",currentText="",document.getElementById("hack-cursor").className="cursor-on",addEntryCharacter()},setAttempts=function(){var e=attempts+" Attempt(s) Left:";for(i=0;i<attempts;i++)e+=" ██";document.getElementById("attemptsleft").innerHTML=e,attempts<=1?(document.getElementById("message").innerHTML="!!! WARNING: LOCKOUT IMMINENT !!!",document.getElementById("message").className="blinker"):(document.getElementById("message").innerHTML="Enter Password",document.getElementById("message").className=""),0==attempts&&(terminalLocked=!0,addFeedback(">Lockout in"),addFeedback(">progress."),setTimeout(function(){document.getElementById("locked").play(),document.getElementById("hacking").innerHTML='<p id="splashpage">TERMINAL LOCKED<br><br>PLEASE CONTACT AN ADMINISTRATOR</p>'},2e3))},clicked=function(e){if(1==enableMinigame&&!terminalLocked)if(document.getElementById("enter").play(),e.classList.contains("word")){var t=getWordFromSpan(e),n=t.replace(/ /g,"");if(t.match(/\.+/))addFeedback(">Error");else if(n!=goalWord){document.getElementById("incorrect").play();var a=0;for(m=0;m<wordlength;m++)goalWord.charAt(m)==n.charAt(m)&&a++;addFeedback(">"+t),addFeedback(">Entry Denied"),addFeedback(">"+a+"/"+wordlength+" correct."),attempts--,setAttempts()}else terminalLocked=!0,document.getElementById("correct").play(),addFeedback(">"+t),addFeedback(">Exact match!"),addFeedback(">Please wait"),addFeedback(">while system"),addFeedback(">is accessed."),setTimeout(login,2e3)}else if(e.parentElement.classList.contains("bracketpair"));else if(e.classList.contains("symbol")){var o=e.innerHTML;addFeedback(">"+o),addFeedback(">Error")}else if(e.classList.contains("bracketpair")){var r=e.children,i="";for(m=0;m<r.length;m++)i+=r[m].innerHTML;addFeedback(">"+i),e.removeAttribute("onclick");var d=e.firstElementChild;if(d.onclick=function(){clicked(d)},hovercleanup(),clickedBrackets.add(d),!hadRefresh&&generateRandomInt(0,10)>7)hadRefresh=!0,attempts=4,setAttempts(),addFeedback(">Allowance"),addFeedback(">replenished.");else{var l=generateRandomInt(0,words.length),s=words[l];words.splice(l,1);for(var c=document.getElementsByClassName("word-"+s),m=0;m<c.length;m++)c[m].textContent=". ",c[m].classList.remove("word"),c[m].classList.add("symbol");addFeedback(">Dud removed.")}}},convertToHex=function(e){for(var t=Number(e).toString(16).toUpperCase();t.length<4;)t="0"+t;return"0x"+t},addBreakIfNeeded=function(e,t){0!=e.length&&e.length%12==0&&t.appendChild(document.createElement("BR"))},addWord=function(e,t,n){for(i=0;i<n.length;i++){var a=document.createElement("SPAN");a.className="word word-"+n,a.onclick=function(e){return function(){clicked(e)}}(a),a.onmouseleave=function(e){return function(){unhover(e)}}(a),a.onmouseenter=function(e){return function(){hover(e)}}(a),a.attributes["data-shouldbe"]=n.charAt(i)+" ",a.attributes["data-charpos"]=i,a.textContent=" ​ ",t.appendChild(a),e.push(a),addBreakIfNeeded(e,t)}},getWordFromSpan=function(e){for(var t=e.className.split(" "),n="",a=0;a<t.length;a++){var o=t[a];o.startsWith("word-")&&(n=o)}return n.replace("word-","").split("").join(" ")+" "},generateRandomInt=function(e,t){return Math.floor(Math.random()*(t-1-e+1)+e)},playKeyboardSound=function(){var e=generateRandomInt(1,9),t=document.getElementById("key"+e);t.currentTime=0,t.play()},detectClosingBracket=function(e){var t=e.innerHTML;if(clickedBrackets.has(e))return!1;var n=e,a=null;switch(t){case"&lt; ":a="&gt; ";break;case"{ ":a="} ";break;case"[ ":a="] ";break;case"( ":a=") ";break;default:a=null}for(var o=[e];;){if(n=n.nextElementSibling,o.push(n),n.innerHTML==a)return o;if(n.classList.contains("word")||""==n.innerHTML)return!1}},spantodelete=null,hovercleanup=function(){if(null!=spantodelete){for(var e=spantodelete.parentNode,t=spantodelete.childNodes,n=[],a=0;a<t.length;a++){var o=t[a];n.push(o)}for(a=0;a<n.length;a++){o=n[a];spantodelete.removeChild(o),e.insertBefore(o,spantodelete)}e.removeChild(spantodelete),spantodelete=null}},hover=function(e){if(1==enableMinigame)if(e.classList.contains("word")){for(var t=getWordFromSpan(e),n=t.replace(/ /g,""),a=document.getElementsByClassName("word-"+n),o=0;o<a.length;o++){a[o].classList.add("highlight")}setEntry(t)}else{e.classList.add("highlight"),setEntry(e.textContent);var r=e.innerHTML[0];if("{"===r||"["===r||"("===r||"&lt; "===e.innerHTML){var i=detectClosingBracket(e),d=e.parentNode;if(i){e.removeAttribute("onclick");var l=document.createElement("SPAN");l.className="bracketpair",l.onclick=function(){clicked(l)},l.onmouseout=function(){hovercleanup()},d.insertBefore(l,e);for(o=0;o<i.length;o++)d.removeChild(i[o]),l.appendChild(i[o]);spantodelete=l,setEntry(l.textContent)}}}},unhover=function(e){if(e.classList.remove("highlight"),e.classList.contains("word")){for(var t=e.className.split(" "),n="",a=0;a<t.length;a++){var o=t[a];o.startsWith("word-")&&(n=o)}var r=document.getElementsByClassName(n);for(a=0;a<r.length;a++){r[a].classList.remove("highlight")}}},generatePointerColumn=function(e,t){var n=document.createElement("DIV"),a=0;do{var o=document.createElement("SPAN");o.textContent=" ​ ",o.attributes["data-shouldbe"]=convertToHex(t),n.appendChild(o),e.push(o);var r=document.createElement("BR");n.appendChild(r),t+=12,a++}while(a<17);return n},generateSymbolColumn=function(e,t){for(var n=["!",'"',"`","$","%","^","&","*","(",")","-","_","+","=","{","[","}","]",":",";","@","'","~","#","<",">",",","?","/","|","\\"],a=0;e.length<204;){var o=document.createElement("SPAN");if(o.className="symbol",o.onmouseenter=function(e){return function(){hover(e)}}(o),o.onmouseleave=function(e){return function(){unhover(e)}}(o),o.onclick=function(e){return function(){clicked(e)}}(o),o.attributes["data-shouldbe"]=n[generateRandomInt(0,n.length)]+" ",o.textContent=" ​ ",t.appendChild(o),e.push(o),addBreakIfNeeded(e,t),a++,e.length+wordlength<204&&a>4&&(45==a||generateRandomInt(0,17)>15)){var r=generateRandomInt(0,allWords.length),i=allWords[r];allWords.splice(r,1),words.push(i),addWord(e,t,i),a=0}}return t},fixImages=function(){var e=document.getElementById("post-container").querySelectorAll("img");for(i=0;i<e.length;i++){var t=e[i],n=t.parentNode;t.src=t.getAttribute("data-src"),t.style.backgroundImage="url("+t.getAttribute("data-src")+")";var a=document.createElement("DIV");a.className="image-container";var o=document.createElement("DIV");o.className="image-color",t.classList.contains("emoji")&&a.classList.add("emoji-container");var r=document.createElement("DIV");r.style.clear="both",n.insertBefore(a,t),n.removeChild(t),a.appendChild(o),a.appendChild(r),o.appendChild(t)}},login=function(){document.getElementById("hacking").style.display="none",document.getElementById("loggedin").style.display="block",window.addEventListener("load",resizeLoggedIn,!1),window.addEventListener("resize",resizeLoggedIn,!1),resizeLoggedIn(),document.getElementById("login").play()},turnOnCursor=function(e){return function(){document.getElementById("cp-cursor").className="cursor-on",e()}},turnOffCursor=function(e){return function(){document.getElementById("cp-cursor").className="cursor-off",e()}},typingEnter=function(e){return function(){document.getElementById("enter").play(),e()}},flashCursor=function(e){return function(){document.getElementById("cp-cursor").className="cursor-flash",e()}},getNextPrint=function(e,t,n,a,o,r){var i=0;return function(){setTimeout(function(){finishedPrinting||(e.previousElementSibling.classList.remove("activeCommandPrompt"),e.classList.add("activeCommandPrompt"),e.innerHTML+=t,r||(o?playPrintBeep():(playKeyboardSound(),i=generateRandomInt(0,40))),a())},n+i)}},playPrintBeep=function(){0==printCount&&document.getElementById("print").play(),(printCount+=1)>4&&(printCount=0)},printCommandPrompt=function(){var e=function(){finishedPrinting=!0,finishedLoading&&setTimeout(beginMinigame,700)};for(i=commandPromptText.length-1;i>=0;i--){textBlock=commandPromptText[i];var t=document.getElementById(textBlock.targetId);if(textBlock.isBreak)e=getNextPrint(t,textBlock.text,textBlock.delay,e,!0,textBlock.isSilent);else if(textBlock.isMachine){printCount=0,e=turnOffCursor(e);var n=textBlock.text;for(j=n.length-1;j>=0;j--)mycharacter=n[j],e=getNextPrint(t,mycharacter,textBlock.delay,e,!0,textBlock.isSilent);e=turnOnCursor(e)}else{e=typingEnter(turnOffCursor(e));n=textBlock.text;for(j=n.length-1;j>=0;j--)mycharacter=n[j],e=getNextPrint(t,mycharacter,textBlock.delay,e,!1,textBlock.isSilent);e=turnOnCursor(e);var a=generateRandomInt(0,800);e=getNextPrint(t,"",500+a,e),e=flashCursor(e)}}e()},printMinigame=function(){for(var e=function(e,t,n){return function(){setTimeout(function(){t.textContent=t.attributes["data-shouldbe"],void 0!=n&&(n.textContent="█"),playPrintBeep(),e()},4)}},t=function(e,t,n){return function(){setTimeout(function(){e.innerHTML+=t,playPrintBeep(),n()},4)}},n=function(){document.getElementById("minigame-prompt").style.display="block",printCount=0,playPrintBeep(),enableMinigame=!0},a=16;a>=0;a--){for(var o=11;o>=0;o--)n=e(n,symbolSpansRight[12*a+o],symbolSpansRight[12*a+o+1]);n=e(n,pointerSpansRight[a],symbolSpansRight[12*a])}for(a=16;a>=0;a--){for(o=11;o>=0;o--)n=e(n,symbolSpansLeft[12*a+o],symbolSpansLeft[12*a+o+1]);n=e(n,pointerSpansLeft[a],symbolSpansLeft[12*a])}var r=document.getElementById("attemptsleft"),i=minigameText[2].text;for(a=i.length-1;a>=0;a--)mycharacter=i[a],n=t(r,mycharacter,n);r=document.getElementById("message");for(a=(i=minigameText[1].text).length-1;a>=0;a--)mycharacter=i[a],n=t(r,mycharacter,n);r=document.getElementById("termlink");for(a=(i=minigameText[0].text).length-1;a>=0;a--)mycharacter=i[a],n=t(r,mycharacter,n);n()},beginMinigame=function(){if(1==e)return!1;var e=!0;document.getElementById("leftpointers").appendChild(ptrleft),document.getElementById("rightpointers").appendChild(ptrright),document.getElementById("loading").style.display="none",document.getElementById("hacking").style.display="block",printMinigame()},finishPreload=function(){generateSymbolColumn(symbolSpansLeft,document.getElementById("leftsymbols")),generateSymbolColumn(symbolSpansRight,document.getElementById("rightsymbols")),insertGoal(),finishedLoading=!0,finishedPrinting?beginMinigame():document.getElementById("loading").onclick=function(){finishedPrinting=!0,beginMinigame()}},preloadHacking=function(){var e=Math.floor(65128*Math.random());ptrleft=generatePointerColumn(pointerSpansLeft,e),ptrright=generatePointerColumn(pointerSpansRight,e+204);var t=new XMLHttpRequest;t.open("GET","https://jetroid-hacking.herokuapp.com/",!0),t.onreadystatechange=function(){if(t.readyState==XMLHttpRequest.DONE&&200==t.status){var e=JSON.parse(t.responseText);goalWord=e.goal,allWords=e.words,wordlength=e.length,finishPreload()}else t.readyState==XMLHttpRequest.DONE&&(goalWord="BONFIRE",allWords=["FALLACY","REPATCH","SWELTER","PROMOTE","SOURCES","PREWORN","DUALITY","VOIDING","BOBBIES","COPPICE","BANDITO","BOILERS","BOXLIKE","CONFORM","CONFIRM","CONFIDE","GUNFIRE","FOXFIRE","CONFINE"],wordlength=7,finishPreload())},t.send(null)},insertGoal=function(){var e=generateRandomInt(0,words.length),t=words[e];words.splice(e,1);for(var n=Array.prototype.slice.call(document.getElementsByClassName("word-"+t)),a=0;a<n.length;a++){var o=n[a];o.classList.remove("word-"+t),o.classList.add("word-"+goalWord);var r=o.attributes["data-charpos"];o.attributes["data-shouldbe"]=goalWord[r]+" "}},turnOn=function(){toggleFullScreen(),document.body.className="";var e=document.getElementById("login");e.onended=function(){printCommandPrompt()},e.play();var t=document.getElementById("hum1"),n=document.getElementById("hum2");t.volume=.2,n.volume=.4,t.play(),n.play(),document.getElementById("hum1").addEventListener("timeupdate",function(){this.currentTime>this.duration-.44&&(this.currentTime=0,this.play())},!1),document.getElementById("hum2").addEventListener("timeupdate",function(){this.currentTime>this.duration-.44&&(this.currentTime=0,this.play())},!1),document.getElementById("click-to-start").style.display="none",document.getElementById("loading").style.display="block"},maximiseInfo=function(){document.getElementById("information-anchor").classList.toggle("open"),document.getElementById("information-text").classList.toggle("open"),document.getElementById("information-expand-shrink").classList.toggle("open"),document.getElementById("information-hide").classList.toggle("open")},hideInfo=function(){document.getElementById("information").classList.toggle("hide"),document.getElementById("information-anchor").classList.remove("open"),document.getElementById("information-text").classList.remove("open"),document.getElementById("information-expand-shrink").classList.remove("open"),document.getElementById("information-hide").classList.remove("open")},mute=function(){var e=document.getElementById("information-mute-unmute");e.classList.toggle("mute");for(var t=document.getElementById("terminal-sounds").childNodes,n=0;n<t.length;n++)e.classList.contains("mute")?t[n].muted=!0:t[n].muted=!1};function toggleFullScreen(){var e=window.document,t=e.documentElement,n=t.requestFullscreen||t.mozRequestFullScreen||t.webkitRequestFullScreen||t.msRequestFullscreen,a=e.exitFullscreen||e.mozCancelFullScreen||e.webkitExitFullscreen||e.msExitFullscreen;e.fullscreenElement||e.mozFullScreenElement||e.webkitFullscreenElement||e.msFullscreenElement?a.call(e):n.call(t)}document.body.className="terminal-off",document.body.onselectstart=function(){return!1},preloadHacking();