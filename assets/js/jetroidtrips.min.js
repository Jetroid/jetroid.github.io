var processtrips=function(){for(var e=[],i=void 0,t=void 0,o="not specified",r="",s=function(e,i){return e[0]===i[0]&&e[1]===i[1]},a=function(){var a,n;n=t,void 0===(a=i)||0===a.length||void 0===n||0===n.length||s(a,n)||e.push({start:i,stop:t,transport:o,intensity:10,to:r}),i=t,o="not specified"},n=0;n<trips.length;n++){var p=trips[n];t=p.arrivalLocation,o=p.arrivalTransport,r=p.name,a(),t=p.location,a(),t=p.departedLocation,a()}for(var l,c,m,d,u,C,g=[];e.length>0;){var h=e.pop();for(n=e.length;n--;){var v=e[n];c=v,void 0,void 0,void 0,void 0,m=(l=h).start,d=c.start,u=l.stop,C=c.stop,(s(m,d)&&s(u,C)||s(m,C)&&s(u,d))&&(e.splice(n,1),h.intensity+=1,"not specified"===h.transport&&(h.transport=v.transport))}g.push(h)}return g},surfaceDistance=function(e,i){var t=Cesium.Cartographic.fromDegrees(e[0],e[1]),o=Cesium.Cartographic.fromDegrees(i[0],i[1]);return.001*new Cesium.EllipsoidGeodesic(t,o).surfaceDistance};Cesium.Ion.defaultAccessToken="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiJlNDk4NTEzNi00OGQzLTRmMTMtOTk0Mi1jOTBmMTk0MzQxODQiLCJpZCI6NzIwNiwic2NvcGVzIjpbImFzciIsImdjIl0sImlhdCI6MTU0ODY2ODE0OH0.si4Hm0cwgNn1CcIltG9jsKp_DfbqXi6UnY4eVdCDqOM";var viewer=new Cesium.Viewer("cesiumContainer",{navigationInstructionsInitiallyVisible:!1,imageryProvider:new Cesium.IonImageryProvider({assetId:3812}),animation:!1,homeButton:!1,fullscreenButton:!1,navigationHelpButton:!1,timeline:!1,baseLayerPicker:!1,geocoder:!1,infoBox:!1,requestRenderMode:!0}),scene=viewer.scene;scene.skyAtmosphere.show=!1,scene.fog.enabled=!1,scene.globe.showGroundAtmosphere=!1,scene.globe.maximumScreenSpaceError=1;var layer=viewer.imageryLayers.addImageryProvider(new Cesium.IonImageryProvider({assetId:3812}));viewer.clock.clockRange=Cesium.ClockRange.LOOP_STOP;for(var startTime=viewer.clock.startTime,midTime=Cesium.JulianDate.addSeconds(startTime,43200,new Cesium.JulianDate),stopTime=Cesium.JulianDate.addSeconds(startTime,86400,new Cesium.JulianDate),realTripsDisplay=new Cesium.DistanceDisplayCondition,arcs=processtrips(),i=0;i<arcs.length;i++){var arc=arcs[i],startLat=arc.start[0],startLon=arc.start[1],stopLat=arc.stop[0],stopLon=arc.stop[1],transportMethod=arc.transport,intensity=arc.intensity+1,color=null,height=25e3,displayCondition=realTripsDisplay;"not specified"===transportMethod?(color=Cesium.Color.BLACK,displayCondition=new Cesium.DistanceDisplayCondition(0,86086*surfaceDistance(arc.start,arc.stop)-330434)):"air"===transportMethod?(color=Cesium.Color.CORAL,height+=5e5):color="boat"===transportMethod?Cesium.Color.CORNFLOWERBLUE:"car"===transportMethod?Cesium.Color.DARKSLATEGREY:"train"===transportMethod?Cesium.Color.DARKSEAGREEN:Cesium.Color.BISQUE;var property=new Cesium.SampledPositionProperty,startPosition=Cesium.Cartesian3.fromDegrees(startLon,startLat,0);property.addSample(startTime,startPosition);var stopPosition=Cesium.Cartesian3.fromDegrees(stopLon,stopLat,0);property.addSample(stopTime,stopPosition);var midPoint=Cesium.Cartographic.fromCartesian(property.getValue(midTime));surfaceDistance(arc.start,arc.stop)<30?midPoint.height=height/25:midPoint.height=height;var midPosition=viewer.scene.globe.ellipsoid.cartographicToCartesian(midPoint,new Cesium.Cartesian3);(property=new Cesium.SampledPositionProperty).addSample(startTime,startPosition),property.addSample(midTime,midPosition),property.addSample(stopTime,stopPosition);var point={pixelSize:8,color:Cesium.Color.TRANSPARENT,outlineColor:color,outlineWidth:3},arcEntity=viewer.entities.add({position:property,path:{resolution:1200,material:new Cesium.PolylineGlowMaterialProperty({glowPower:.24,color:color}),width:intensity,leadTime:1e10,trailTime:1e10,distanceDisplayCondition:displayCondition}});arcEntity.position.setInterpolationOptions({interpolationDegree:5,interpolationAlgorithm:Cesium.LagrangePolynomialApproximation})}var globeFocus=function(e,i,t){viewer.camera.flyTo({destination:Cesium.Cartesian3.fromDegrees(i,e,t)}),window.scrollTo({top:0,left:0,behavior:"smooth"})};globeFocus(trips[trips.length-1].location[0],trips[trips.length-1].location[1],1e7);